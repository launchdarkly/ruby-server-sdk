<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: LaunchDarkly::Integrations::Util::FeatureStoreCore
  
    &mdash; LaunchDarkly Ruby SDK
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "LaunchDarkly::Integrations::Util::FeatureStoreCore";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Integrations.html" title="LaunchDarkly::Integrations (module)">Integrations</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Util.html" title="LaunchDarkly::Integrations::Util (module)">Util</a></span></span>
     &raquo; 
    <span class="title">FeatureStoreCore</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: LaunchDarkly::Integrations::Util::FeatureStoreCore
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ldclient-rb/integrations/util/store_wrapper.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>This module describes the methods that you must implement on your own object in order to
use <span class='object_link'><a href="CachingStoreWrapper.html" title="LaunchDarkly::Integrations::Util::CachingStoreWrapper (class)">CachingStoreWrapper</a></span>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_all_internal-instance_method" title="#get_all_internal (instance method)">#<strong>get_all_internal</strong>(kind)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Retrieves all entities of the specified kind.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_internal-instance_method" title="#get_internal (instance method)">#<strong>get_internal</strong>(kind, key)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Retrieves a single entity.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#init_internal-instance_method" title="#init_internal (instance method)">#<strong>init_internal</strong>(all_data)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Initializes the store.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialized_internal%3F-instance_method" title="#initialized_internal? (instance method)">#<strong>initialized_internal?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Checks whether this store has been initialized.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop-instance_method" title="#stop (instance method)">#<strong>stop</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Performs any necessary cleanup to shut down the store when the client is being shut down.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upsert_internal-instance_method" title="#upsert_internal (instance method)">#<strong>upsert_internal</strong>(kind, item)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Attempts to add or update an entity.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="get_all_internal-instance_method">
  
    #<strong>get_all_internal</strong>(kind)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Retrieves all entities of the specified kind. This is the same as <span class='object_link'><a href="../../Interfaces/FeatureStore.html#all-instance_method" title="LaunchDarkly::Interfaces::FeatureStore#all (method)">LaunchDarkly::Interfaces::FeatureStore#all</a></span>
except that 1. the wrapper will take care of filtering out deleted entities by checking the
<code>:deleted</code> property, so you can just return exactly what was in the data store, and 2. the
wrapper will take care of checking and updating the cache if caching is enabled.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>kind</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the kind of entity to get</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash where each key is the entity&#39;s <code>:key</code> property and each value
is the entity</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/integrations/util/store_wrapper.rb', line 205</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_all_internal'>get_all_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_kind'>kind</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_internal-instance_method">
  
    #<strong>get_internal</strong>(kind, key)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Retrieves a single entity. This is the same as <span class='object_link'><a href="../../Interfaces/FeatureStore.html#get-instance_method" title="LaunchDarkly::Interfaces::FeatureStore#get (method)">LaunchDarkly::Interfaces::FeatureStore#get</a></span>
except that 1. the wrapper will take care of filtering out deleted entities by checking the
<code>:deleted</code> property, so you can just return exactly what was in the data store, and 2. the
wrapper will take care of checking and updating the cache if caching is enabled.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>kind</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the kind of entity to get</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the unique key of the entity to get</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the entity; nil if the key was not found</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/integrations/util/store_wrapper.rb', line 192</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_internal'>get_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="init_internal-instance_method">
  
    #<strong>init_internal</strong>(all_data)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Initializes the store. This is the same as <span class='object_link'><a href="../../Interfaces/FeatureStore.html#init-instance_method" title="LaunchDarkly::Interfaces::FeatureStore#init (method)">LaunchDarkly::Interfaces::FeatureStore#init</a></span>,
but the wrapper will take care of updating the cache if caching is enabled.</p>

<p>If possible, the store should update the entire data set atomically. If that is not possible,
it should iterate through the outer hash and then the inner hash using the existing iteration
order of those hashes (the SDK will ensure that the items were inserted into the hashes in
the correct order), storing each item, and then delete any leftover items at the very end.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>all_data</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash where each key is one of the data kind objects, and each
value is in turn a hash of string keys to entities</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/integrations/util/store_wrapper.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_init_internal'>init_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_all_data'>all_data</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialized_internal?-instance_method">
  
    #<strong>initialized_internal?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Checks whether this store has been initialized. This is the same as
<span class='object_link'><a href="../../Interfaces/FeatureStore.html#initialized%3F-instance_method" title="LaunchDarkly::Interfaces::FeatureStore#initialized? (method)">LaunchDarkly::Interfaces::FeatureStore#initialized?</a></span> except that there is less of a concern
for efficiency, because the wrapper will use caching and memoization in order to call the method
as little as possible.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if the store is in an initialized state</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/integrations/util/store_wrapper.rb', line 233</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialized_internal?'>initialized_internal?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop-instance_method">
  
    #<strong>stop</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Performs any necessary cleanup to shut down the store when the client is being shut down.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/integrations/util/store_wrapper.rb', line 241</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop'>stop</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="upsert_internal-instance_method">
  
    #<strong>upsert_internal</strong>(kind, item)  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Attempts to add or update an entity. This is the same as <span class='object_link'><a href="../../Interfaces/FeatureStore.html#upsert-instance_method" title="LaunchDarkly::Interfaces::FeatureStore#upsert (method)">LaunchDarkly::Interfaces::FeatureStore#upsert</a></span>
except that 1. the wrapper will take care of updating the cache if caching is enabled, and 2.
the method is expected to return the final state of the entity (i.e. either the <code>item</code>
parameter if the update succeeded, or the previously existing entity in the store if the
update failed; this is used for the caching logic).</p>

<p>Note that FeatureStoreCore does not have a <code>delete</code> method. This is because <span class='object_link'><a href="CachingStoreWrapper.html" title="LaunchDarkly::Integrations::Util::CachingStoreWrapper (class)">CachingStoreWrapper</a></span>
implements <code>delete</code> by simply calling <code>upsert</code> with an item whose <code>:deleted</code> property is true.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>kind</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the kind of entity to add or update</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the entity to add or update</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the entity as it now exists in the store after the update</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>5.5.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/integrations/util/store_wrapper.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upsert_internal'>upsert_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Jan  3 16:54:29 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.3.0).
</div>

    </div>
  </body>
</html>