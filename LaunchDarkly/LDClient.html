<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: LaunchDarkly::LDClient
  
    &mdash; LaunchDarkly Ruby SDK
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "LaunchDarkly::LDClient";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (L)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span>
     &raquo; 
    <span class="title">LDClient</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: LaunchDarkly::LDClient
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">LaunchDarkly::LDClient</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>Forwardable</dd>
  </dl>
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ldclient-rb/ldclient.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A client for LaunchDarkly. Client instances are thread-safe. Users
should create a single client instance for the lifetime of the application.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#big_segment_store_status_provider-instance_method" title="#big_segment_store_status_provider (instance method)">#<strong>big_segment_store_status_provider</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns an interface for tracking the status of a Big Segment store.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#data_source_status_provider-instance_method" title="#data_source_status_provider (instance method)">#<strong>data_source_status_provider</strong>  &#x21d2; LaunchDarkly::Interfaces::DataSource::StatusProvider </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns an interface for tracking the status of the data source.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#data_store_status_provider-instance_method" title="#data_store_status_provider (instance method)">#<strong>data_store_status_provider</strong>  &#x21d2; LaunchDarkly::Interfaces::DataStore::StatusProvider </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns an interface for tracking the status of a persistent data store.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#flag_tracker-instance_method" title="#flag_tracker (instance method)">#<strong>flag_tracker</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns an interface for tracking changes in feature flag configurations.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_hook-instance_method" title="#add_hook (instance method)">#<strong>add_hook</strong>(hook)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Add a hook to the client.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_flags_state-instance_method" title="#all_flags_state (instance method)">#<strong>all_flags_state</strong>(context, options = {})  &#x21d2; FeatureFlagsState </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns a <span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span> object that encapsulates the state of all feature flags for a given context, including the flag values and also metadata that can be used on the front end.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Releases all network connections and other resources held by the client, making it no longer usable.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flush-instance_method" title="#flush (instance method)">#<strong>flush</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tells the client that all pending analytics events should be delivered as soon as possible.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#identify-instance_method" title="#identify (instance method)">#<strong>identify</strong>(context)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Registers the context.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(sdk_key, config = Config.default, wait_for_sec = 5)  &#x21d2; LDClient </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a new client instance that connects to LaunchDarkly.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialized%3F-instance_method" title="#initialized? (instance method)">#<strong>initialized?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns whether the client has been initialized and is ready to serve feature flag requests.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#migration_variation-instance_method" title="#migration_variation (instance method)">#<strong>migration_variation</strong>(key, context, default_stage)  &#x21d2; Array&lt;Symbol, Interfaces::Migrations::OpTracker&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This method returns the migration stage of the migration feature flag for the given evaluation context.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#postfork-instance_method" title="#postfork (instance method)">#<strong>postfork</strong>(wait_for_sec = 5)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Re-initializes an existing client after a process fork.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#secure_mode_hash-instance_method" title="#secure_mode_hash (instance method)">#<strong>secure_mode_hash</strong>(context)  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a hash string that can be used by the JavaScript SDK to identify a context.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#track-instance_method" title="#track (instance method)">#<strong>track</strong>(event_name, context, data = nil, metric_value = nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tracks that a context performed an event.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#track_migration_op-instance_method" title="#track_migration_op (instance method)">#<strong>track_migration_op</strong>(tracker)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tracks the results of a migrations operation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#variation-instance_method" title="#variation (instance method)">#<strong>variation</strong>(key, context, default)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Determines the variation of a feature flag to present for a context.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#variation_detail-instance_method" title="#variation_detail (instance method)">#<strong>variation_detail</strong>(key, context, default)  &#x21d2; EvaluationDetail </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Determines the variation of a feature flag for a context, like <span class='object_link'><a href="#variation-instance_method" title="LaunchDarkly::LDClient#variation (method)">#variation</a></span>, but also provides additional information about how this value was calculated.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(sdk_key, config = Config.default, wait_for_sec = 5)  &#x21d2; <tt><span class='object_link'><a href="" title="LaunchDarkly::LDClient (class)">LDClient</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Creates a new client instance that connects to LaunchDarkly. A custom
configuration parameter can also supplied to specify advanced options,
but for most use cases, the default configuration is appropriate.</p>

<p>The client will immediately attempt to connect to LaunchDarkly and retrieve
your feature flag data. If it cannot successfully do so within the time limit
specified by <code>wait_for_sec</code>, the constructor will return a client that is in
an uninitialized state. See <span class='object_link'><a href="#initialized%3F-instance_method" title="LaunchDarkly::LDClient#initialized? (method)">#initialized?</a></span> for more details.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>sdk_key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the SDK key for your LaunchDarkly account</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>config</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Config.html" title="LaunchDarkly::Config (class)">Config</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Config.default</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>an optional client configuration object</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wait_for_sec</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>5</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>maximum time (in seconds) to wait for initialization</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_sdk_key'>sdk_key</span><span class='comma'>,</span> <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Config.html" title="LaunchDarkly::Config (class)">Config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_default'><span class='object_link'><a href="Config.html#default-class_method" title="LaunchDarkly::Config.default (method)">default</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_wait_for_sec'>wait_for_sec</span> <span class='op'>=</span> <span class='int'>5</span><span class='rparen'>)</span>
  <span class='comment'># Note that sdk_key is normally a required parameter, and a nil value would cause the SDK to
</span>  <span class='comment'># fail in most configurations. However, there are some configurations where it would be OK
</span>  <span class='comment'># (offline = true, *or* we are using LDD mode or the file data source and events are disabled
</span>  <span class='comment'># so we&#39;re not connecting to any LD services) so rather than try to check for all of those
</span>  <span class='comment'># up front, we will let the constructors for the data source implementations implement this
</span>  <span class='comment'># fail-fast as appropriate, and just check here for the part regarding events.
</span>  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_offline?'>offline?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_send_events'>send_events</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sdk_key must not be nil</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_sdk_key'>sdk_key</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>

  <span class='ivar'>@sdk_key</span> <span class='op'>=</span> <span class='id identifier rubyid_sdk_key'>sdk_key</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_instance_id'>instance_id</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span>
  <span class='ivar'>@config</span> <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span>

  <span class='id identifier rubyid_start_up'>start_up</span><span class='lparen'>(</span><span class='id identifier rubyid_wait_for_sec'>wait_for_sec</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="big_segment_store_status_provider-instance_method">
  
    #<strong>big_segment_store_status_provider</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns an interface for tracking the status of a Big Segment store.</p>

<p>The <span class='object_link'><a href="Interfaces/BigSegmentStoreStatusProvider.html" title="LaunchDarkly::Interfaces::BigSegmentStoreStatusProvider (module)">Interfaces::BigSegmentStoreStatusProvider</a></span> has methods for checking whether the Big Segment store
is (as far as the SDK knows) currently operational and tracking changes in this status.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


627
628
629</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 627</span>

<span class='kw'>def</span> <span class='id identifier rubyid_big_segment_store_status_provider'>big_segment_store_status_provider</span>
  <span class='ivar'>@big_segment_store_status_provider</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="data_source_status_provider-instance_method">
  
    #<strong>data_source_status_provider</strong>  &#x21d2; <tt><span class='object_link'><a href="Interfaces/DataSource/StatusProvider.html" title="LaunchDarkly::Interfaces::DataSource::StatusProvider (module)">LaunchDarkly::Interfaces::DataSource::StatusProvider</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns an interface for tracking the status of the data source.</p>

<p>The data source is the mechanism that the SDK uses to get feature flag
configurations, such as a streaming connection (the default) or poll
requests. The <span class='object_link'><a href="Interfaces/DataSource/StatusProvider.html" title="LaunchDarkly::Interfaces::DataSource::StatusProvider (module)">Interfaces::DataSource::StatusProvider</a></span> has
methods for checking whether the data source is (as far as the SDK knows)
currently operational and tracking changes in this status.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Interfaces/DataSource/StatusProvider.html" title="LaunchDarkly::Interfaces::DataSource::StatusProvider (module)">LaunchDarkly::Interfaces::DataSource::StatusProvider</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


654
655
656</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 654</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_source_status_provider'>data_source_status_provider</span>
  <span class='ivar'>@data_source_status_provider</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="data_store_status_provider-instance_method">
  
    #<strong>data_store_status_provider</strong>  &#x21d2; <tt><span class='object_link'><a href="Interfaces/DataStore/StatusProvider.html" title="LaunchDarkly::Interfaces::DataStore::StatusProvider (module)">LaunchDarkly::Interfaces::DataStore::StatusProvider</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns an interface for tracking the status of a persistent data store.</p>

<p>The <span class='object_link'><a href="Interfaces/DataStore/StatusProvider.html" title="LaunchDarkly::Interfaces::DataStore::StatusProvider (module)">Interfaces::DataStore::StatusProvider</a></span> has methods for
checking whether the data store is (as far as the SDK knows) currently
operational, tracking changes in this status, and getting cache
statistics. These are only relevant for a persistent data store; if you
are using an in-memory data store, then this method will return a stub
object that provides no information.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Interfaces/DataStore/StatusProvider.html" title="LaunchDarkly::Interfaces::DataStore::StatusProvider (module)">LaunchDarkly::Interfaces::DataStore::StatusProvider</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


641
642
643</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 641</span>

<span class='kw'>def</span> <span class='id identifier rubyid_data_store_status_provider'>data_store_status_provider</span>
  <span class='ivar'>@data_store_status_provider</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="flag_tracker-instance_method">
  
    #<strong>flag_tracker</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns an interface for tracking changes in feature flag configurations.</p>

<p>The <span class='object_link'><a href="Interfaces/FlagTracker.html" title="LaunchDarkly::Interfaces::FlagTracker (module)">Interfaces::FlagTracker</a></span> contains methods for
requesting notifications about feature flag changes using an event
listener model.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


663
664
665</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 663</span>

<span class='kw'>def</span> <span class='id identifier rubyid_flag_tracker'>flag_tracker</span>
  <span class='ivar'>@flag_tracker</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_hook-instance_method">
  
    #<strong>add_hook</strong>(hook)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Add a hook to the client. In order to register a hook before the client starts, please use the <code>hooks</code> property of
#LDConfig.</p>

<p>Hooks provide entrypoints which allow for observation of SDK functions.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>hook</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Interfaces/Hooks/Hook.html" title="LaunchDarkly::Interfaces::Hooks::Hook (module)">Interfaces::Hooks::Hook</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185
186
187
188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_hook'>add_hook</span><span class='lparen'>(</span><span class='id identifier rubyid_hook'>hook</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_hook'>hook</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Interfaces.html" title="LaunchDarkly::Interfaces (module)">Interfaces</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Interfaces/Hooks.html" title="LaunchDarkly::Interfaces::Hooks (module)">Hooks</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Interfaces/Hooks/Hook.html" title="LaunchDarkly::Interfaces::Hooks::Hook (module)">Hook</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[LDClient] Attempted to add a hook that does not include the LaunchDarkly::Intefaces::Hooks::Hook mixin. Ignoring.</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='ivar'>@hooks</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_hook'>hook</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_flags_state-instance_method">
  
    #<strong>all_flags_state</strong>(context, options = {})  &#x21d2; <tt><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a <span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span> object that encapsulates the state of all feature flags for a given context,
including the flag values and also metadata that can be used on the front end. This method does not
send analytics events back to LaunchDarkly.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash or object describing the context requesting the flags,</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Optional parameters to control how the state is generated</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:client_side_only</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>True if only flags marked for use with the
client-side SDK should be included in the state. By default, all flags are included.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:with_reasons</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>True if evaluation reasons should be included
in the state (see <span class='object_link'><a href="#variation_detail-instance_method" title="LaunchDarkly::LDClient#variation_detail (method)">#variation_detail</a></span>). By default, they are not included.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:details_only_for_tracked_flags</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'><p>True if any flag metadata that is
normally only used for event generation - such as flag versions and evaluation reasons - should be
omitted for any flag that does not have event tracking or debugging turned on. This reduces the size
of the JSON data if you are passing the flag state to the front end.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a <span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span> object which can be serialized to JSON</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 548</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_flags_state'>all_flags_state</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FeatureFlagsState.html#initialize-instance_method" title="LaunchDarkly::FeatureFlagsState#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_offline?'>offline?</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_initialized?'>initialized?</span>
    <span class='kw'>if</span> <span class='ivar'>@store</span><span class='period'>.</span><span class='id identifier rubyid_initialized?'>initialized?</span>
        <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Called all_flags_state before client initialization; using last known values from data store</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='kw'>else</span>
        <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Called all_flags_state before client initialization. Data store not available; returning empty state</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
        <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FeatureFlagsState.html#initialize-instance_method" title="LaunchDarkly::FeatureFlagsState#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='op'>::</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_valid?'>valid?</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[LDClient] Context was invalid for all_flags_state (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FeatureFlagsState.html#initialize-instance_method" title="LaunchDarkly::FeatureFlagsState#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_features'>features</span> <span class='op'>=</span> <span class='ivar'>@store</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='lparen'>(</span><span class='const'>FEATURES</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_exn'>exn</span>
    <span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_log_exception'>log_exception</span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to read flags for all_flags_state</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exn'>exn</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FeatureFlagsState.html#initialize-instance_method" title="LaunchDarkly::FeatureFlagsState#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>false</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_state'>state</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="FeatureFlagsState.html" title="LaunchDarkly::FeatureFlagsState (class)">FeatureFlagsState</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="FeatureFlagsState.html#initialize-instance_method" title="LaunchDarkly::FeatureFlagsState#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_client_only'>client_only</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:client_side_only</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_with_reasons'>with_reasons</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:with_reasons</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_details_only_if_tracked'>details_only_if_tracked</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:details_only_for_tracked_flags</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_client_only'>client_only</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:clientSide</span><span class='rbracket'>]</span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>
    <span class='kw'>begin</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_eval_result'>eval_result</span><span class='comma'>,</span> <span class='id identifier rubyid_eval_state'>eval_state</span><span class='rparen'>)</span> <span class='op'>=</span> <span class='ivar'>@evaluator</span><span class='period'>.</span><span class='id identifier rubyid_evaluate'>evaluate</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_detail'>detail</span> <span class='op'>=</span> <span class='id identifier rubyid_eval_result'>eval_result</span><span class='period'>.</span><span class='id identifier rubyid_detail'>detail</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_exn'>exn</span>
      <span class='id identifier rubyid_detail'>detail</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="EvaluationDetail.html" title="LaunchDarkly::EvaluationDetail (class)">EvaluationDetail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="EvaluationDetail.html#initialize-instance_method" title="LaunchDarkly::EvaluationDetail#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="EvaluationReason.html" title="LaunchDarkly::EvaluationReason (class)">EvaluationReason</a></span></span><span class='op'>::</span><span class='id identifier rubyid_error'><span class='object_link'><a href="EvaluationReason.html#error-class_method" title="LaunchDarkly::EvaluationReason.error (method)">error</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="EvaluationReason.html" title="LaunchDarkly::EvaluationReason (class)">EvaluationReason</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="EvaluationReason.html#ERROR_EXCEPTION-constant" title="LaunchDarkly::EvaluationReason::ERROR_EXCEPTION (constant)">ERROR_EXCEPTION</a></span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='const'>Util</span><span class='period'>.</span><span class='id identifier rubyid_log_exception'>log_exception</span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error evaluating flag \&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot; in all_flags_state</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_exn'>exn</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_requires_experiment_data'>requires_experiment_data</span> <span class='op'>=</span> <span class='id identifier rubyid_experiment?'>experiment?</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='comma'>,</span> <span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_flag_state'>flag_state</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>key:</span> <span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:key</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>value:</span> <span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span>
      <span class='label'>variation:</span> <span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_variation_index'>variation_index</span><span class='comma'>,</span>
      <span class='label'>reason:</span> <span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_reason'>reason</span><span class='comma'>,</span>
      <span class='label'>prerequisites:</span> <span class='id identifier rubyid_eval_state'>eval_state</span><span class='period'>.</span><span class='id identifier rubyid_prerequisites'>prerequisites</span><span class='comma'>,</span>
      <span class='label'>version:</span> <span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>trackEvents:</span> <span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:trackEvents</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_requires_experiment_data'>requires_experiment_data</span><span class='comma'>,</span>
      <span class='label'>trackReason:</span> <span class='id identifier rubyid_requires_experiment_data'>requires_experiment_data</span><span class='comma'>,</span>
      <span class='label'>debugEventsUntilDate:</span> <span class='id identifier rubyid_f'>f</span><span class='lbracket'>[</span><span class='symbol'>:debugEventsUntilDate</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_add_flag'>add_flag</span><span class='lparen'>(</span><span class='id identifier rubyid_flag_state'>flag_state</span><span class='comma'>,</span> <span class='id identifier rubyid_with_reasons'>with_reasons</span><span class='comma'>,</span> <span class='id identifier rubyid_details_only_if_tracked'>details_only_if_tracked</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_state'>state</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    #<strong>close</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Releases all network connections and other resources held by the client, making it no longer usable.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


612
613
614
615
616
617
618
619</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 612</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[LDClient] Closing LaunchDarkly client...</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='ivar'>@data_source</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span>
  <span class='ivar'>@event_processor</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span>
  <span class='ivar'>@big_segment_store_manager</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span>
  <span class='ivar'>@store</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span>
  <span class='ivar'>@shared_executor</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flush-instance_method">
  
    #<strong>flush</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells the client that all pending analytics events should be delivered as soon as possible.</p>

<p>When the LaunchDarkly client generates analytics events (from <span class='object_link'><a href="#variation-instance_method" title="LaunchDarkly::LDClient#variation (method)">#variation</a></span>, <span class='object_link'><a href="#variation_detail-instance_method" title="LaunchDarkly::LDClient#variation_detail (method)">#variation_detail</a></span>,
<span class='object_link'><a href="#identify-instance_method" title="LaunchDarkly::LDClient#identify (method)">#identify</a></span>, or <span class='object_link'><a href="#track-instance_method" title="LaunchDarkly::LDClient#track (method)">#track</a></span>), they are queued on a worker thread. The event thread normally
sends all queued events to LaunchDarkly at regular intervals, controlled by the
<span class='object_link'><a href="Config.html#flush_interval-instance_method" title="LaunchDarkly::Config#flush_interval (method)">Config#flush_interval</a></span> option. Calling <code>flush</code> triggers a send without waiting for the
next interval.</p>

<p>Flushing is asynchronous, so this method will return before it is complete. However, if you
call <span class='object_link'><a href="#close-instance_method" title="LaunchDarkly::LDClient#close (method)">#close</a></span>, events are guaranteed to be sent before that method returns.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 204</span>

<span class='kw'>def</span> <span class='id identifier rubyid_flush'>flush</span>
  <span class='ivar'>@event_processor</span><span class='period'>.</span><span class='id identifier rubyid_flush'>flush</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="identify-instance_method">
  
    #<strong>identify</strong>(context)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Registers the context. This method simply creates an analytics event containing the context
properties, so that LaunchDarkly will know about that context if it does not already.</p>

<p>Calling <span class='object_link'><a href="#variation-instance_method" title="LaunchDarkly::LDClient#variation (method)">#variation</a></span> or <span class='object_link'><a href="#variation_detail-instance_method" title="LaunchDarkly::LDClient#variation_detail (method)">#variation_detail</a></span> also sends the context information to
LaunchDarkly (if events are enabled), so you only need to use <span class='object_link'><a href="#identify-instance_method" title="LaunchDarkly::LDClient#identify (method)">#identify</a></span> if you
want to identify the context without evaluating a flag.</p>

<p>Note that event delivery is asynchronous, so the event may not actually be sent
until later; see <span class='object_link'><a href="#flush-instance_method" title="LaunchDarkly::LDClient#flush (method)">#flush</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash or object describing the context to register</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


459
460
461
462
463
464
465
466
467
468
469
470
471
472</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 459</span>

<span class='kw'>def</span> <span class='id identifier rubyid_identify'>identify</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='period'>.</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_valid?'>valid?</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Identify called with invalid context: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Identify called with empty key</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='ivar'>@event_processor</span><span class='period'>.</span><span class='id identifier rubyid_record_identify_event'>record_identify_event</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initialized?-instance_method">
  
    #<strong>initialized?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns whether the client has been initialized and is ready to serve feature flag requests.</p>

<p>If this returns false, it means that the client did not succeed in connecting to
LaunchDarkly within the time limit that you specified in the constructor. It could
still succeed in connecting at a later time (on another thread), or it could have
given up permanently (for instance, if your SDK key is invalid). In the meantime,
any call to <span class='object_link'><a href="#variation-instance_method" title="LaunchDarkly::LDClient#variation (method)">#variation</a></span> or <span class='object_link'><a href="#variation_detail-instance_method" title="LaunchDarkly::LDClient#variation_detail (method)">#variation_detail</a></span> will behave as follows:</p>

<ol>
<li><p>It will check whether the feature store already contains data (that is, you
are using a database-backed store and it was populated by a previous run of this
application). If so, it will use the last known feature flag data.</p></li>
<li><p>Failing that, it will return the value that you specified for the <code>default</code>
parameter of <span class='object_link'><a href="#variation-instance_method" title="LaunchDarkly::LDClient#variation (method)">#variation</a></span> or <span class='object_link'><a href="#variation_detail-instance_method" title="LaunchDarkly::LDClient#variation_detail (method)">#variation_detail</a></span>.</p></li>
</ol>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if the client has been initialized</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 243</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialized?'>initialized?</span>
  <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_offline?'>offline?</span> <span class='op'>||</span> <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_use_ldd?'>use_ldd?</span> <span class='op'>||</span> <span class='ivar'>@data_source</span><span class='period'>.</span><span class='id identifier rubyid_initialized?'>initialized?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="migration_variation-instance_method">
  
    #<strong>migration_variation</strong>(key, context, default_stage)  &#x21d2; <tt>Array&lt;Symbol, <span class='object_link'><a href="Interfaces/Migrations/OpTracker.html" title="LaunchDarkly::Interfaces::Migrations::OpTracker (module)">Interfaces::Migrations::OpTracker</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This method returns the migration stage of the migration feature flag for the given evaluation context.</p>

<p>This method returns the default stage if there is an error or the flag does not exist. If the default stage is not
a valid stage, then a default stage of &#39;off&#39; will be used instead.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>default_stage</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Symbol, <span class='object_link'><a href="Interfaces/Migrations/OpTracker.html" title="LaunchDarkly::Interfaces::Migrations::OpTracker (module)">Interfaces::Migrations::OpTracker</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 418</span>

<span class='kw'>def</span> <span class='id identifier rubyid_migration_variation'>migration_variation</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='const'>Migrations</span><span class='op'>::</span><span class='const'>VALID_STAGES</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_default_stage'>default_stage</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[LDClient] default_stage </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_default_stage'>default_stage</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid stage; continuing with &#39;off&#39; as default</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_default_stage'>default_stage</span> <span class='op'>=</span> <span class='const'>Migrations</span><span class='op'>::</span><span class='const'>STAGE_OFF</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='op'>::</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_evaluate_with_hooks'>evaluate_with_hooks</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='comma'>,</span> <span class='symbol'>:migration_variation</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='id identifier rubyid_flag'>flag</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_variation_with_flag'>variation_with_flag</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_stage'>stage</span> <span class='op'>=</span> <span class='id identifier rubyid_detail'>detail</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='id identifier rubyid_stage'>stage</span> <span class='op'>=</span> <span class='id identifier rubyid_stage'>stage</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span> <span class='kw'>if</span> <span class='id identifier rubyid_stage'>stage</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbol'>:to_sym</span>

    <span class='kw'>if</span> <span class='const'>Migrations</span><span class='op'>::</span><span class='const'>VALID_STAGES</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_stage'>stage</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_tracker'>tracker</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Migrations</span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Impl/Migrations/OpTracker.html" title="LaunchDarkly::Impl::Migrations::OpTracker (class)">OpTracker</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Impl/Migrations/OpTracker.html#initialize-instance_method" title="LaunchDarkly::Impl::Migrations::OpTracker#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_flag'>flag</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='rparen'>)</span>
      <span class='kw'>next</span> <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>EvaluationWithHookResult</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>stage:</span> <span class='id identifier rubyid_stage'>stage</span><span class='comma'>,</span> <span class='label'>tracker:</span> <span class='id identifier rubyid_tracker'>tracker</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_detail'>detail</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>Evaluator</span><span class='period'>.</span><span class='id identifier rubyid_error_result'>error_result</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="EvaluationReason.html" title="LaunchDarkly::EvaluationReason (class)">EvaluationReason</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="EvaluationReason.html#ERROR_WRONG_TYPE-constant" title="LaunchDarkly::EvaluationReason::ERROR_WRONG_TYPE (constant)">ERROR_WRONG_TYPE</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_tracker'>tracker</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Migrations</span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Impl/Migrations/OpTracker.html" title="LaunchDarkly::Impl::Migrations::OpTracker (class)">OpTracker</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Impl/Migrations/OpTracker.html#initialize-instance_method" title="LaunchDarkly::Impl::Migrations::OpTracker#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_flag'>flag</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='rparen'>)</span>

    <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>EvaluationWithHookResult</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='label'>stage:</span> <span class='id identifier rubyid_default_stage'>default_stage</span><span class='comma'>,</span> <span class='label'>tracker:</span> <span class='id identifier rubyid_tracker'>tracker</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:stage</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='symbol'>:tracker</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="postfork-instance_method">
  
    #<strong>postfork</strong>(wait_for_sec = 5)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Re-initializes an existing client after a process fork.</p>

<p>The SDK relies on multiple background threads to operate correctly. When a process forks, <code>these threads are not
available to the child &lt;https://apidock.com/ruby/Process/fork/class&gt;</code>.</p>

<p>As a result, the SDK will not function correctly in the child process until it is re-initialized.</p>

<p>This method is effectively equivalent to instantiating a new client. Future iterations of the SDK will provide
increasingly efficient re-initializing improvements.</p>

<p>Note that any configuration provided to the SDK will need to survive the forking process independently. For this
reason, it is recommended that any listener or hook integrations be added postfork unless you are certain it can
survive the forking process.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>wait_for_sec</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>5</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>maximum time (in seconds) to wait for initialization</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 83</span>

<span class='kw'>def</span> <span class='id identifier rubyid_postfork'>postfork</span><span class='lparen'>(</span><span class='id identifier rubyid_wait_for_sec'>wait_for_sec</span> <span class='op'>=</span> <span class='int'>5</span><span class='rparen'>)</span>
  <span class='ivar'>@data_source</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@event_processor</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@big_segment_store_manager</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_start_up'>start_up</span><span class='lparen'>(</span><span class='id identifier rubyid_wait_for_sec'>wait_for_sec</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="secure_mode_hash-instance_method">
  
    #<strong>secure_mode_hash</strong>(context)  &#x21d2; <tt>String</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Creates a hash string that can be used by the JavaScript SDK to identify a context.
For more information, see <a href="https://docs.launchdarkly.com/sdk/features/secure-mode#ruby">Secure mode</a>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash string or nil if the provided context was invalid</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 215</span>

<span class='kw'>def</span> <span class='id identifier rubyid_secure_mode_hash'>secure_mode_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='period'>.</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_valid?'>valid?</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>secure_mode_hash called with invalid context: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>HMAC</span><span class='period'>.</span><span class='id identifier rubyid_hexdigest'>hexdigest</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sha256</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@sdk_key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_fully_qualified_key'>fully_qualified_key</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="track-instance_method">
  
    #<strong>track</strong>(event_name, context, data = nil, metric_value = nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Tracks that a context performed an event. This method creates a &quot;custom&quot; analytics event
containing the specified event name (key), context properties, and optional data.</p>

<p>Note that event delivery is asynchronous, so the event may not actually be sent
until later; see <span class='object_link'><a href="#flush-instance_method" title="LaunchDarkly::LDClient#flush (method)">#flush</a></span>.</p>

<p>As of this version’s release date, the LaunchDarkly service does not support the <code>metricValue</code>
parameter. As a result, specifying <code>metricValue</code> will not yet produce any different behavior
from omitting it. Refer to the <a href="https://docs.launchdarkly.com/sdk/features/events#ruby">SDK reference guide</a>
for the latest status.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>event_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the event</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash or object describing the context to track</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>An optional hash containing any additional data associated with the event</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>metric_value</span>
      
      
        <span class='type'>(<tt>Number</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>A numeric value used by the LaunchDarkly experimentation
feature in numeric custom metrics. Can be omitted if this event is used by only
non-numeric metrics. This field will also be returned as part of the custom event
for Data Export.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


495
496
497
498
499
500
501
502
503</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 495</span>

<span class='kw'>def</span> <span class='id identifier rubyid_track'>track</span><span class='lparen'>(</span><span class='id identifier rubyid_event_name'>event_name</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_metric_value'>metric_value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='period'>.</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_valid?'>valid?</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Track called with invalid context: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='ivar'>@event_processor</span><span class='period'>.</span><span class='id identifier rubyid_record_custom_event'>record_custom_event</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_event_name'>event_name</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_metric_value'>metric_value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="track_migration_op-instance_method">
  
    #<strong>track_migration_op</strong>(tracker)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Tracks the results of a migrations operation. This event includes measurements which can be used to enhance the
observability of a migration within the LaunchDarkly UI.</p>

<p>This event should be generated through <span class='object_link'><a href="Interfaces/Migrations/OpTracker.html" title="LaunchDarkly::Interfaces::Migrations::OpTracker (module)">Interfaces::Migrations::OpTracker</a></span>. If you are using the
<span class='object_link'><a href="Interfaces/Migrations/Migrator.html" title="LaunchDarkly::Interfaces::Migrations::Migrator (module)">Interfaces::Migrations::Migrator</a></span> to handle migrations, this event will be created and emitted
automatically.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tracker</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Interfaces/Migrations/OpTracker.html" title="LaunchDarkly::Interfaces::Migrations::OpTracker (module)">LaunchDarkly::Interfaces::Migrations::OpTracker</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


515
516
517
518
519
520
521
522
523
524
525
526
527
528
529</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 515</span>

<span class='kw'>def</span> <span class='id identifier rubyid_track_migration_op'>track_migration_op</span><span class='lparen'>(</span><span class='id identifier rubyid_tracker'>tracker</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_tracker'>tracker</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Interfaces.html" title="LaunchDarkly::Interfaces (module)">Interfaces</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Interfaces/Migrations.html" title="LaunchDarkly::Interfaces::Migrations (module)">Migrations</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Interfaces/Migrations/OpTracker.html" title="LaunchDarkly::Interfaces::Migrations::OpTracker (module)">OpTracker</a></span></span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid op tracker received in track_migration_op</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_event'>event</span> <span class='op'>=</span> <span class='id identifier rubyid_tracker'>tracker</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>String</span>
    <span class='ivar'>@config</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[LDClient] Error occurred generating migration op event; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>


  <span class='ivar'>@event_processor</span><span class='period'>.</span><span class='id identifier rubyid_record_migration_op_event'>record_migration_op_event</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="variation-instance_method">
  
    #<strong>variation</strong>(key, context, default)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Determines the variation of a feature flag to present for a context.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the unique feature key for the feature flag, as shown
on the LaunchDarkly dashboard</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash or LDContext instance describing the context requesting the flag</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>default</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>the default value of the flag; this is used if there is an error
condition making it impossible to find or evaluate the flag</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>the variation for the provided context, or the default value if there&#39;s an error</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260
261
262
263
264
265
266</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 258</span>

<span class='kw'>def</span> <span class='id identifier rubyid_variation'>variation</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='op'>::</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_evaluate_with_hooks'>evaluate_with_hooks</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='comma'>,</span> <span class='symbol'>:variation</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_variation_with_flag'>variation_with_flag</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>EvaluationWithHookResult</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_detail'>detail</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_evaluation_detail'>evaluation_detail</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="variation_detail-instance_method">
  
    #<strong>variation_detail</strong>(key, context, default)  &#x21d2; <tt><span class='object_link'><a href="EvaluationDetail.html" title="LaunchDarkly::EvaluationDetail (class)">EvaluationDetail</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Determines the variation of a feature flag for a context, like <span class='object_link'><a href="#variation-instance_method" title="LaunchDarkly::LDClient#variation (method)">#variation</a></span>, but also
provides additional information about how this value was calculated.</p>

<p>The return value of <code>variation_detail</code> is an <span class='object_link'><a href="EvaluationDetail.html" title="LaunchDarkly::EvaluationDetail (class)">EvaluationDetail</a></span> object, which has
three properties: the result value, the positional index of this value in the flag&#39;s
list of variations, and an object describing the main reason why this value was
selected. See <span class='object_link'><a href="EvaluationDetail.html" title="LaunchDarkly::EvaluationDetail (class)">EvaluationDetail</a></span> for more on these properties.</p>

<p>Calling <code>variation_detail</code> instead of <code>variation</code> also causes the &quot;reason&quot; data to
be included in analytics events, if you are capturing detailed event data for this flag.</p>

<p>For more information, see the reference guide on
<a href="https://docs.launchdarkly.com/sdk/concepts/evaluation-reasons">Evaluation reasons</a>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the unique feature key for the feature flag, as shown
on the LaunchDarkly dashboard</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>Hash</tt>, <tt><span class='object_link'><a href="LDContext.html" title="LaunchDarkly::LDContext (class)">LDContext</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a hash or object describing the context requesting the flag,</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>default</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>the default value of the flag; this is used if there is an error
condition making it impossible to find or evaluate the flag</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="EvaluationDetail.html" title="LaunchDarkly::EvaluationDetail (class)">EvaluationDetail</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>an object describing the result</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


291
292
293
294
295
296
297
298
299</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ldclient-rb/ldclient.rb', line 291</span>

<span class='kw'>def</span> <span class='id identifier rubyid_variation_detail'>variation_detail</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_context'>context</span> <span class='op'>=</span> <span class='const'>Impl</span><span class='op'>::</span><span class='const'>Context</span><span class='op'>::</span><span class='id identifier rubyid_make_context'>make_context</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_evaluate_with_hooks'>evaluate_with_hooks</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='comma'>,</span> <span class='symbol'>:variation_detail</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_detail'>detail</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span> <span class='op'>=</span> <span class='id identifier rubyid_evaluate_internal'>evaluate_internal</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='id identifier rubyid_default'>default</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="../LaunchDarkly.html" title="LaunchDarkly (module)">LaunchDarkly</a></span></span><span class='op'>::</span><span class='const'>Impl</span><span class='op'>::</span><span class='const'>EvaluationWithHookResult</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_detail'>detail</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_evaluation_detail'>evaluation_detail</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Apr 16 18:28:41 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.0.7).
</div>

    </div>
  </body>
</html>